function sendFile(){Office.context.document.getFileAsync(Office.FileType.Compressed,{sliceSize:1e3},function(e){if(e.status==Office.AsyncResultStatus.Succeeded){var t=e.value,c={file:t,counter:0,sliceCount:t.sliceCount};updateStatus("Getting file of "+t.size+" bytes"),getSlice(c)}else updateStatus(e.status)})}function getSlice(e){e.file.getSliceAsync(e.counter,function(t){t.status==Office.AsyncResultStatus.Succeeded?(updateStatus("Sending piece "+(e.counter+1)+" of "+e.sliceCount),sendSlice(t.value,e)):updateStatus(t.status)})}function sendSlice(e,t){console.info("sendSlice",e),closeFile(t)}function closeFile(e){e.file.closeAsync(function(e){updateStatus("succeeded"==e.status?"File closed.":"File couldn't be closed.")})}function updateStatus(e){var t=$("#status");t.innerHTML+=e+"<br/>"}Office.initialize=function(e){$(document).ready(function(){$("#submit").click(function(){sendFile()}),updateStatus("Ready to send file.")})};